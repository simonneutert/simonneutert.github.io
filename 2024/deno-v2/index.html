<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />


<title>NoBuild Javascript for a Deno on Roda experiment | Simon Neutert</title>

<meta name="description" content="I am a Ruby (on Rails) developer and open source enthusiast. Super interest in Clojure. Based in Ingelheim, next to Mainz and Wiesbaden (Rhein-Main)." />

<link rel="stylesheet" href="/_bridgetown/static/index.POPT2NFP.css" data-turbo-track="reload" />

<script src="/_bridgetown/static/index.Q4PHQU7R.js" data-turbo-track="reload" defer></script>


    <link type="application/atom+xml" rel="alternate" href="/feed.xml" title="Simon Neutert" />
  </head>
  <body class="post ">
    <header>
  <!-- 
  <img src="/images/logo.svg" alt="Logo" />
  -->
</header>

<nav>
  <ul>
    <li><a href="/">Home</a></li>
    <!-- <li><a href="/telegram">On Telegram</a></li> -->
    <!-- <li><a href="/about">About</a></li> -->
    <li><a href="/posts">Blog</a></li>
  </ul>
</nav>


    <main>
      <a href="/posts" style="text-decoration:none; text-align=center;">↖️ Show all posts</a>

<hr />

<h1>NoBuild Javascript for a Deno on Roda experiment</h1>

<p>Deno has my interest. 🦕🛼</p>

<p>I fiddled with bun, too, but the feel was a bit different.</p>

<p><code class="highlighter-rouge">$ deno compile</code> - what’s not to love?</p>

<p>Since the release of Deno v2, I can’t help but think: Can’t I use Deno’s tools in some helpful ways?</p>

<p>Following my GitHub you could see, that I enjoy working with <a href="https://roda.jeremyevans.net/">Roda</a>. My current undercover side project became one of the biggest codebases, I’ve ever written for myself. And JS is lacking tests. 🤙 #yolo #e2elifeguard</p>

<ul>
  <li><a href="https://roda.jeremyevans.net/">Roda</a></li>
  <li><a href="https://rodauth.jeremyevans.net/">Rodauth</a></li>
  <li>Vanilla JS</li>
  <li><a href="https://htmx.org/">HTMX</a></li>
  <li>MapboxJS</li>
</ul>

<p>What parts of Deno could be useful in this context? <br />
The pieces that somehow spoke to me were:</p>

<ul>
  <li>deno fmt</li>
  <li>deno lint</li>
  <li>deno test</li>
</ul>

<p>Could Deno remove the need for setting up and keeping up to date with eslint and prettier? <br />
Maybe I wouldn’t have to setup and maintain jest or mocha even.</p>

<h2 id="path-to-nobuild">Path to NoBuild</h2>

<p>Linting and formatting is straightforward. I’ve added a <code class="highlighter-rouge">deno fmt</code> and <code class="highlighter-rouge">deno lint</code> to my justfile.</p>

<div class="language-make highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nl">test-js</span><span class="o">:</span>
  <span class="err">deno</span> <span class="err">test</span> <span class="err">spec_js</span>

<span class="nl">test-js-watch</span><span class="o">:</span>
	deno <span class="nb">test</span> <span class="nt">--watch</span> spec_js

<span class="nl">lint-js</span><span class="o">:</span>
	deno lint public/js
	deno lint <span class="nt">--rules-exclude</span><span class="o">=</span>no-window,no-window-prefix,no-global-assign assets/js

<span class="nl">test-js</span><span class="o">:</span>
	deno <span class="nb">test </span>spec_js/<span class="k">**</span>/<span class="k">*</span>test.<span class="k">*</span><span class="o">{</span>js,ts,jsx,tsx<span class="o">}</span>
</code></pre></div></div>

<p>This rules-excude will prevent Deno from complaining about global variables like <code class="highlighter-rouge">window</code> and <code class="highlighter-rouge">document</code>. This needs to be good enough for now.</p>

<p>Roda already ships with an asset bundling plugin. It’s a simple plugin that takes all your assets and bundles them into a single file. Yet some parts of the Javascript parts are becoming more business logic heavy and will benefit from unit testing. Here’s how Deno steps in.</p>

<p>I’ve created a <code class="highlighter-rouge">spec_js</code> folder in the root of my project. This is where I’ll put all my JS tests.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="p">{</span> <span class="nx">assertEquals</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">jsr:@std/assert</span><span class="dl">"</span><span class="p">;</span>
<span class="k">import</span> <span class="p">{</span> <span class="nx">Elvis</span> <span class="p">}</span> <span class="k">from</span> <span class="dl">"</span><span class="s2">../public/js/rock-and-roll-superstar.js</span><span class="dl">"</span><span class="p">;</span>

<span class="nx">Deno</span><span class="p">.</span><span class="nf">test</span><span class="p">(</span><span class="dl">"</span><span class="s2">assert Elvis is in the house</span><span class="dl">"</span><span class="p">,</span> <span class="p">()</span> <span class="o">=&gt;</span> <span class="p">{</span>
  <span class="kd">const</span> <span class="nx">elvis</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">Elvis</span><span class="p">();</span>
  <span class="nf">assertEquals</span><span class="p">(</span><span class="nx">elvis</span><span class="p">.</span><span class="nf">pelvis</span><span class="p">()</span> <span class="p">,</span> <span class="dl">"</span><span class="s2">Elvis is in the house!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">});</span>
</code></pre></div></div>

<p>I know this is a bit unusual. <br />
But so is using Roda. <br />
Deno v2 won’t change its APIs for quite some time (🤞). And if it will … I mean it’ll break just the tests… right?</p>

<blockquote>
  <p>Rewriting the js test suite is easy. <br />
It’s a system rewrite that fails. <br />
And why haven’t you used Rust in the first place?</p>

  <p>- Charles Ponzi</p>
</blockquote>


<hr />

<a id="btn-previous" href="/2024/stream-db-rows/" style="text-decoration:none;">⬅️ Read previous</a>

<a id="btn-next" href="/2024/deno-v2-ink/" style="float: right; text-decoration:none;">Read next ➡️</a>

    </main>

    <footer>
  <p style="text-align:center"><strong>
    <a href="/feed.xml">Feed</a>
  </strong></p>

  <hr />

  <h6>Imprint</h6>
  <p>
    <strong>Simon Neutert</strong><br />
    <span id="imprint-address">
      Postfach 1120, 55258 Ingelheim
    </span>
  </p>
  <p style="text-align:center"><strong>
    Generated using <a href="https://www.bridgetownrb.com">Bridgetown</a>
  </strong></p>
</footer>

  </body>
</html>
